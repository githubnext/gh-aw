const{runLogParser}=require("./log_parser_bootstrap.cjs"),{generateConversationMarkdown,generateInformationSection,formatInitializationSummary,formatToolUse,parseLogEntries}=require("./log_parser_shared.cjs");function main(){runLogParser({parseLog:parseClaudeLog,parserName:"Claude",supportsDirectories:!1})}function parseClaudeLog(logContent){try{const logEntries=parseLogEntries(logContent);if(!logEntries)return{markdown:"## Agent Log Summary\n\nLog format not recognized as Claude JSON array or JSONL.\n",mcpFailures:[],maxTurnsHit:!1,logEntries:[]};const mcpFailures=[];let markdown=generateConversationMarkdown(logEntries,{formatToolCallback:(toolUse,toolResult)=>formatToolUse(toolUse,toolResult,{includeDetailedParameters:!1}),formatInitCallback:initEntry=>{const result=formatInitializationSummary(initEntry,{includeSlashCommands:!0,mcpFailureCallback:server=>{const errorDetails=[];if(server.error&&errorDetails.push(`**Error:** ${server.error}`),server.stderr){const maxStderrLength=500,stderr=server.stderr.length>maxStderrLength?server.stderr.substring(0,maxStderrLength)+"...":server.stderr;errorDetails.push(`**Stderr:** \`${stderr}\``)}return void 0!==server.exitCode&&null!==server.exitCode&&errorDetails.push(`**Exit Code:** ${server.exitCode}`),server.command&&errorDetails.push(`**Command:** \`${server.command}\``),server.message&&errorDetails.push(`**Message:** ${server.message}`),server.reason&&errorDetails.push(`**Reason:** ${server.reason}`),errorDetails.length>0?errorDetails.map(detail=>`  - ${detail}\n`).join(""):""}});return result.mcpFailures&&mcpFailures.push(...result.mcpFailures),result}}).markdown;const lastEntry=logEntries[logEntries.length-1];markdown+=generateInformationSection(lastEntry);let maxTurnsHit=!1;const maxTurns=process.env.GH_AW_MAX_TURNS;if(maxTurns&&lastEntry&&lastEntry.num_turns){const configuredMaxTurns=parseInt(maxTurns,10);!isNaN(configuredMaxTurns)&&lastEntry.num_turns>=configuredMaxTurns&&(maxTurnsHit=!0)}return{markdown,mcpFailures,maxTurnsHit,logEntries}}catch(error){return{markdown:`## Agent Log Summary\n\nError parsing Claude log (tried both JSON array and JSONL formats): ${error instanceof Error?error.message:String(error)}\n`,mcpFailures:[],maxTurnsHit:!1,logEntries:[]}}}"undefined"!=typeof module&&module.exports&&(module.exports={parseClaudeLog}),main();