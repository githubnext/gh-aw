function parseAllowedItems(envValue){const trimmed=envValue?.trim();if(trimmed)return trimmed.split(",").map(item=>item.trim()).filter(item=>item)}function parseMaxCount(envValue,defaultValue=3){if(!envValue)return{valid:!0,value:defaultValue};const parsed=parseInt(envValue,10);return isNaN(parsed)||parsed<1?{valid:!1,error:`Invalid max value: ${envValue}. Must be a positive integer`}:{valid:!0,value:parsed}}function resolveTarget(params){const{targetConfig,item,context,itemType,supportsPR=!1}=params,isIssueContext="issues"===context.eventName||"issue_comment"===context.eventName,isPRContext="pull_request"===context.eventName||"pull_request_review"===context.eventName||"pull_request_review_comment"===context.eventName,target=targetConfig||"triggering";if("triggering"===target)if(supportsPR){if(!isIssueContext&&!isPRContext)return{success:!1,error:`Target is "triggering" but not running in issue or pull request context, skipping ${itemType}`,shouldFail:!1}}else if(!isPRContext)return{success:!1,error:`Target is "triggering" but not running in pull request context, skipping ${itemType}`,shouldFail:!1};let itemNumber,contextType;if("*"===target){const numberField=supportsPR&&(item.item_number||item.issue_number)||item.pull_request_number;if(!numberField)return{success:!1,error:`Target is "*" but no ${supportsPR?"item_number/issue_number":"pull_request_number"} specified in ${itemType} item`,shouldFail:!0};if(itemNumber="number"==typeof numberField?numberField:parseInt(String(numberField),10),isNaN(itemNumber)||itemNumber<=0)return{success:!1,error:`Invalid ${supportsPR?"item_number/issue_number/pull_request_number":"pull_request_number"} specified: ${numberField}`,shouldFail:!0};contextType=supportsPR&&(item.item_number||item.issue_number)?"issue":"pull request"}else if("triggering"!==target){if(itemNumber=parseInt(target,10),isNaN(itemNumber)||itemNumber<=0)return{success:!1,error:`Invalid ${supportsPR?"issue":"pull request"} number in target configuration: ${target}`,shouldFail:!0};contextType=supportsPR?"issue":"pull request"}else if(isIssueContext){if(!context.payload.issue)return{success:!1,error:"Issue context detected but no issue found in payload",shouldFail:!0};itemNumber=context.payload.issue.number,contextType="issue"}else if(isPRContext){if(!context.payload.pull_request)return{success:!1,error:"Pull request context detected but no pull request found in payload",shouldFail:!0};itemNumber=context.payload.pull_request.number,contextType="pull request"}return itemNumber?{success:!0,number:itemNumber,contextType:contextType||(supportsPR?"issue":"pull request")}:{success:!1,error:`Could not determine ${supportsPR?"issue or pull request":"pull request"} number`,shouldFail:!0}}module.exports={parseAllowedItems,parseMaxCount,resolveTarget};