async function updateActivationComment(github,context,core,itemUrl,itemNumber,itemType="pull_request"){const itemLabel="issue"===itemType?"issue":"pull request",linkMessage="issue"===itemType?`\n\n✅ Issue created: [#${itemNumber}](${itemUrl})`:`\n\n✅ Pull request created: [#${itemNumber}](${itemUrl})`;await updateActivationCommentWithMessage(github,context,core,linkMessage,itemLabel)}async function updateActivationCommentWithCommit(github,context,core,commitSha,commitUrl){const message=`\n\n✅ Commit pushed: [\`${commitSha.substring(0,7)}\`](${commitUrl})`;await updateActivationCommentWithMessage(github,context,core,message,"commit")}async function updateActivationCommentWithMessage(github,context,core,message,label=""){const commentId=process.env.GH_AW_COMMENT_ID,commentRepo=process.env.GH_AW_COMMENT_REPO;if(!commentId)return void core.info("No activation comment to update (GH_AW_COMMENT_ID not set)");core.info(`Updating activation comment ${commentId}`);let repoOwner=context.repo.owner,repoName=context.repo.repo;if(commentRepo){const parts=commentRepo.split("/");2===parts.length?(repoOwner=parts[0],repoName=parts[1]):core.warning(`Invalid comment repo format: ${commentRepo}, expected "owner/repo". Falling back to context.repo.`)}core.info(`Updating comment in ${repoOwner}/${repoName}`);const isDiscussionComment=commentId.startsWith("DC_");try{if(isDiscussionComment){const currentComment=await github.graphql("\n        query($commentId: ID!) {\n          node(id: $commentId) {\n            ... on DiscussionComment {\n              body\n            }\n          }\n        }",{commentId});if(!currentComment?.node?.body)return void core.warning("Unable to fetch current comment body, comment may have been deleted or is inaccessible");const updatedBody=currentComment.node.body+message,comment=(await github.graphql("\n        mutation($commentId: ID!, $body: String!) {\n          updateDiscussionComment(input: { commentId: $commentId, body: $body }) {\n            comment {\n              id\n              url\n            }\n          }\n        }",{commentId,body:updatedBody})).updateDiscussionComment.comment,successMessage=label?`Successfully updated discussion comment with ${label} link`:"Successfully updated discussion comment";core.info(successMessage),core.info(`Comment ID: ${comment.id}`),core.info(`Comment URL: ${comment.url}`)}else{const currentComment=await github.request("GET /repos/{owner}/{repo}/issues/comments/{comment_id}",{owner:repoOwner,repo:repoName,comment_id:parseInt(commentId,10),headers:{Accept:"application/vnd.github+json"}});if(!currentComment?.data?.body)return void core.warning("Unable to fetch current comment body, comment may have been deleted");const updatedBody=currentComment.data.body+message,response=await github.request("PATCH /repos/{owner}/{repo}/issues/comments/{comment_id}",{owner:repoOwner,repo:repoName,comment_id:parseInt(commentId,10),body:updatedBody,headers:{Accept:"application/vnd.github+json"}}),successMessage=label?`Successfully updated comment with ${label} link`:"Successfully updated comment";core.info(successMessage),core.info(`Comment ID: ${response.data.id}`),core.info(`Comment URL: ${response.data.html_url}`)}}catch(error){core.warning(`Failed to update activation comment: ${error instanceof Error?error.message:String(error)}`)}}module.exports={updateActivationComment,updateActivationCommentWithCommit};