---
name: "Go File Size Reduction Campaign (Project 64)"
description: "Systematically reduce oversized Go files to improve maintainability. Success: all files ≤800 LOC, maintain coverage, no regressions."
on:
  schedule:
    - cron: "0 18 * * *"
  workflow_dispatch:
concurrency:
  group: "campaign-go-file-size-reduction-project64-orchestrator-${{ github.ref }}"
  cancel-in-progress: false
engine: copilot
safe-outputs:
    add-comment:
        max: 10
    update-project:
        github-token: ${{ secrets.GH_AW_PROJECT_GITHUB_TOKEN }}
        max: 10
runs-on: ubuntu-latest
roles:
  - "admin"
  - "maintainer"
  - "write"
tools:
    bash:
        - '*'
    edit: null
    github:
        toolsets:
            - default
            - actions
            - code_security
    repo-memory:
        - branch-name: memory/campaigns
          file-glob:
            - go-file-size-reduction-project64/**
          id: campaigns
---

<!-- This file was automatically generated by gh-aw. DO NOT EDIT. -->
<!-- Source: .github/workflows/go-file-size-reduction-project64.campaign.md -->

# Campaign Orchestrator

This workflow orchestrates the 'Go File Size Reduction Campaign (Project 64)' campaign.

- Tracker label: `campaign:go-file-size-reduction-project64`
- Objective: Reduce all Go files to ≤800 lines of code while maintaining test coverage and preventing regressions
- KPIs:
  - Files reduced to target size (primary): baseline 0 → target 100 over 90 days percent
  - Test coverage maintained (supporting): baseline 80 → target 80 over 7 days percent
- Associated workflows: daily-file-diet
- Memory paths: memory/campaigns/go-file-size-reduction-project64/**
- Metrics glob: `memory/campaigns/go-file-size-reduction-project64/metrics/*.json`
- Project URL: https://github.com/orgs/githubnext/projects/64
- Governance: max new items per run: 5
- Governance: max discovery items per run: 50
- Governance: max discovery pages per run: 5
- Governance: max project updates per run: 10
- Governance: max comments per run: 10

Each time this orchestrator runs, generate a concise status report for this campaign.

### Project Board Integration

Execute state writes using the `update-project` safe-output. All writes must target this exact project URL:

**Project URL**: https://github.com/orgs/githubnext/projects/64

**Campaign ID**: Extract from tracker label `campaign:go-file-size-reduction-project64` (format: `campaign:CAMPAIGN_ID`)


#### Adding New Issues

When adding an issue to the project board:
```
update-project:
  project: "https://github.com/orgs/githubnext/projects/64"
  item_url: "ISSUE_URL"
  status: "Todo"  # or "Done" if issue is already closed
  campaign_id: "CAMPAIGN_ID"  # Required: extract from tracker label campaign:go-file-size-reduction-project64
```

**Note**: If your project board has `Start Date` and `End Date` fields, these will be **automatically populated** from the issue/PR timestamps:
- `Start Date` is set from the issue's `createdAt` timestamp
- `End Date` is set from the issue's `closedAt` timestamp (if closed)

No additional configuration is needed. The dates are extracted in ISO format (YYYY-MM-DD) and only populate if the fields exist and aren't already set. This enables roadmap timeline visualization.

#### Updating Existing Items

When updating status for an existing board item:
```
update-project:
  project: "https://github.com/orgs/githubnext/projects/64"
  item_url: "ISSUE_URL"
  status: "Done"  # or "In Progress", "Todo"
  campaign_id: "CAMPAIGN_ID"  # Required: extract from tracker label campaign:go-file-size-reduction-project64
```

#### Idempotency

- If an issue is already on the board with matching status → Skip (no-op)
- If an issue is already on the board with different status → Update status field only
- If an issue URL is invalid or deleted → Record failure, continue with remaining items

#### Write Operation Rules

1. **Batch writes separately** - Do not mix reads and writes in the same operation
2. **Validate before writing** - Confirm issue URL exists and is accessible
3. **Record all outcomes** - Log success/failure for each write operation
4. **Never infer state** - Only update based on explicit issue state (open/closed)
5. **Fail gracefully** - If a write fails, record error and continue with remaining operations

### Summary

Execute all four phases in order:
1. **Read State** - Discover worker issues and query project board
2. **Make Decisions** - Determine what to add, update, or mark complete
3. **Write State** - Execute additions and updates via update-project
4. **Report** - Generate status report with execution outcomes

Remember: Workers are immutable and campaign-agnostic. All coordination, sequencing, and state management happens in this orchestrator. The GitHub Project board is the single source of truth for campaign state.
