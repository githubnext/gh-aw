---
# Pattern: Discussion Bot
# Complexity: Beginner
# Use Case: Create and manage GitHub Discussions for reports, announcements, or engagement
name: Discussion Bot
description: Creates and manages GitHub Discussions with formatted content and auto-cleanup
on:
  schedule:
    # TODO: Customize schedule for your needs (daily, weekly, etc.)
    - cron: "0 6 * * *"  # Daily at 6 AM UTC
  workflow_dispatch:
permissions:
  contents: read
  discussions: write
engine: copilot
tools:
  github:
    mode: remote
    toolsets: [discussions]
safe-outputs:
  create-discussion:
    # TODO: Customize discussion settings
    category: "General"
    title-prefix: "[Daily] "
    max: 1
    expires: 7d
    close-older-discussions: true
  close-discussion:
    max: 10
  upload-asset:
strict: true
---

# Discussion Bot

Automatically create and manage GitHub Discussions for reports, announcements, or community engagement.

## Your Task

Create a daily/scheduled discussion with relevant content for your repository community.

### Choose Your Discussion Type

# TODO: Uncomment and customize ONE of these patterns, or create your own

#### Pattern 1: Daily Activity Report

```markdown
## ğŸ“Š Daily Activity Report

**Date**: [Today's Date]

### Summary
- **New Issues**: [count] ([view all](link))
- **Closed Issues**: [count]
- **Merged PRs**: [count]
- **New Contributors**: [list]

### Highlights
[Most active issues/PRs or interesting developments]

### Trending Topics
[Most discussed labels or themes]

---
*Report generated by [workflow name]*
```

#### Pattern 2: Weekly Roundup

```markdown
## ğŸ—“ï¸ Weekly Roundup - [Week of Date]

### ğŸ‰ Achievements This Week
- [Major milestones, releases, or accomplishments]

### ğŸ“ˆ Statistics
- Issues opened/closed
- PRs merged
- New stars/forks

### ğŸ”¥ Hot Topics
[Most discussed issues or features]

### ğŸ‘¥ Top Contributors
[Thank contributors for their work]

### ğŸ“… Coming Next Week
[Upcoming events, releases, or focus areas]

---
*Generated weekly on Monday*
```

#### Pattern 3: Release Announcement

```markdown
## ğŸš€ Release v[VERSION]

We're excited to announce the release of version [VERSION]!

### âœ¨ What's New
- [New feature 1]
- [New feature 2]
- [Enhancement 1]

### ğŸ› Bug Fixes
- [Fixed issue 1]
- [Fixed issue 2]

### ğŸ“š Documentation
- [Updated docs links]

### âš ï¸ Breaking Changes
[If any, with migration guide]

### ğŸ™ Thank You
Thanks to all contributors: [list]

---
[Link to release notes] | [Link to migration guide]
```

#### Pattern 4: Community Q&A

```markdown
## ğŸ’¬ Weekly Q&A Thread - [Date]

Welcome to this week's Q&A thread!

### ğŸ¤” Got Questions?
Ask anything about the project:
- How to use features
- Best practices
- Contribution questions
- General discussions

### ğŸ“£ Announcements
[Any updates or news]

### ğŸ¯ This Week's Focus
[Current development priorities or RFC discussions]

---
*Community Q&A posted every [schedule]*
```

#### Pattern 5: Performance/Metrics Dashboard

```markdown
## ğŸ“Š Repository Health Dashboard - [Date]

### ğŸƒ Performance Metrics
- Build time: [average]
- Test coverage: [percentage]
- Open issues: [count] ([trend])
- Response time: [average time to first response]

### ğŸ“ˆ Trends
[Charts or ASCII graphs showing trends]

### âš ï¸ Action Items
[Issues or PRs needing attention]

### âœ… Successes
[Improvements or achievements]

---
*Metrics updated daily*
```

## Implementation Steps

1. **Gather Data**:
   ```markdown
   # TODO: Customize data collection for your discussion type
   - Use GitHub tools to fetch recent issues, PRs, releases
   - Calculate relevant statistics
   - Identify trending topics or labels
   - List new contributors
   ```

2. **Format Content**:
   ```markdown
   Create well-formatted markdown with:
   - Clear sections with headers
   - Bullet points for readability
   - Links to relevant issues/PRs
   - Emoji for visual appeal (but don't overdo it)
   - Tables for structured data
   ```

3. **Generate Visualizations** (Optional):
   ```markdown
   If including charts or graphs:
   - Use Python matplotlib or similar
   - Save to /tmp/gh-aw/assets/
   - Reference in discussion with upload-asset
   ```

4. **Create Discussion**:
   ```markdown
   Use create-discussion safe-output with:
   - Title: Descriptive and includes date/version
   - Category: Choose appropriate category
   - Body: Your formatted content
   - Close older discussions: Set to true to avoid clutter
   ```

5. **Cleanup** (Optional):
   ```markdown
   Use close-discussion to close older discussions:
   - Find discussions with same title prefix
   - Older than specified expiration
   - Keep only the most recent
   ```

## Customization Guide

### Adjust Schedule

# TODO: Choose your schedule
```yaml
# Daily at 6 AM UTC
schedule:
  - cron: "0 6 * * *"

# Weekly on Monday at 9 AM UTC
schedule:
  - cron: "0 9 * * 1"

# Every 12 hours
schedule:
  - cron: "0 */12 * * *"

# Monthly on the 1st at midnight
schedule:
  - cron: "0 0 1 * *"
```

### Choose Discussion Category

# TODO: Set category to match your repository's discussions
```yaml
safe-outputs:
  create-discussion:
    category: "General"      # General discussions
    # category: "Announcements"  # For release notes
    # category: "Q&A"            # For community questions
    # category: "Show and tell"  # For showcases
```

### Configure Auto-Cleanup

# TODO: Adjust cleanup settings
```yaml
safe-outputs:
  create-discussion:
    expires: 7d                    # Close discussions older than 7 days
    close-older-discussions: true  # Auto-close old ones
    max: 1                         # Create at most 1 per run
  close-discussion:
    max: 10                        # Close up to 10 old discussions
```

### Add Asset Uploads

For discussions with charts, images, or data files:

```yaml
safe-outputs:
  upload-asset:  # Enable asset uploads
```

Then in your workflow:
```python
# Generate chart
import matplotlib.pyplot as plt
plt.savefig('/tmp/gh-aw/assets/chart.png')

# Reference in discussion markdown
![Chart](chart.png)
```

## Example Outputs

### Daily Report Example

```markdown
## ğŸ“Š Daily Activity Report - December 29, 2025

### Summary
- **New Issues**: 5 ([view all](link))
- **Closed Issues**: 3
- **Merged PRs**: 8
- **New Contributors**: @user1, @user2

### ğŸ”¥ Hot Topics
- #1234 - Feature request for dark mode (12 comments)
- #1235 - Bug in authentication flow (urgent)

### ğŸ¯ Needs Attention
- 3 PRs waiting for review
- 2 issues labeled "help wanted"

### ğŸ“ˆ 7-Day Trends
- Issues: 35 opened, 28 closed (ğŸ“ˆ +20% open rate)
- PRs: 42 opened, 38 merged (â­ 90% merge rate)

---
*Report generated by [Daily Activity Report](run-url)*
```

### Weekly Q&A Example

```markdown
## ğŸ’¬ Weekly Q&A Thread - Week of December 23, 2025

Welcome to this week's Q&A thread! ğŸ‰

### ğŸ“£ Announcements
- Version 2.0 released! Check out the [release notes](#)
- New contributor guide published
- Holiday schedule: Limited support Dec 24-26

### ğŸ¯ This Week's Focus
We're focusing on performance improvements and bug fixes. See our [roadmap discussion](#) for details.

### ğŸ’¡ Frequently Asked Questions
Based on last week's questions:

**Q: How do I configure X?**  
A: Check the [configuration guide](#) or see example Y.

**Q: Can feature Z work with A?**  
A: Yes! See PR #1234 for implementation details.

### ğŸ¤” Ask Your Questions Below!
What questions do you have this week?

---
*Posted every Monday at 9 AM UTC*
```

## Advanced Features

### Include Data Visualizations

```python
# TODO: Customize visualization code
import pandas as pd
import matplotlib.pyplot as plt

# Load data
data = fetch_issue_data()  # Your data fetching logic

# Create visualization
plt.figure(figsize=(10, 6))
plt.plot(data['dates'], data['counts'])
plt.title('Issue Activity Over Time')
plt.savefig('/tmp/gh-aw/assets/activity-chart.png')

# Reference in discussion
discussion_body = """
## Activity Trends

![Issue Activity](activity-chart.png)

[Additional content...]
"""
```

### Smart Cleanup Logic

```markdown
Close older discussions intelligently:
- Keep pinned discussions
- Keep discussions with active conversations (recent comments)
- Only close discussions with the same title prefix
- Respect the expires duration
```

### Threading and Replies

```markdown
For ongoing discussions:
- Create a main discussion thread
- Have the bot reply with updates
- Keep context across updates
```

## Related Examples

- **Basic usage**: `examples/label-trigger-discussion.md` - Discussion trigger example
- **Production examples**:
  - `.github/workflows/daily-issues-report.md` - Daily report with discussion creation
  - `.github/workflows/copilot-pr-merged-report.md` - PR merge report discussion

## Tips

- **Be consistent**: Post on the same schedule so users know when to expect it
- **Be concise**: Don't overwhelm with too much information
- **Be visual**: Use emoji, tables, and charts to make content scannable
- **Be interactive**: Ask questions or encourage discussion
- **Be respectful**: Auto-close old discussions to avoid clutter
- **Test formatting**: Use workflow_dispatch to preview before scheduling

## Security Considerations

- This workflow only reads repository data and creates discussions
- Uses `strict: true` for enhanced security
- Network access not required (unless fetching external data)
- All operations validated through safe-outputs

---

**Pattern Info**:
- Complexity: Beginner
- Trigger: Scheduled (customizable) + manual dispatch
- Safe Outputs: create_discussion, close_discussion, upload_asset
- Tools: GitHub (discussions)
